---
title: "Chronicle First-Year Survey: ED vs. RD"
author: "Shari Tian"
date: "12/12/2020"
output:
  pdf_document: default
  html_document: default
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = FALSE,
                      warning = FALSE,
                      message = FALSE)
```

```{r packages, message=FALSE, warning=FALSE}
library(ggplot2)
library(dplyr)
library(readxl)
library(knitr)
library(RColorBrewer)
library(wesanderson)
```

## Data  

```{r data}
Survey_Responses <- read_excel("~/Survey Responses.xlsx", 
    sheet = "Sheet1")
View(Survey_Responses)
```

## EDA  

#### Overall ED  


```{r countED}
Survey_Responses %>%
  count(ED) %>%
  mutate(prop = n/sum(n)) %>%
  kable()
``` 


#### Gender and Sexual Orientation

There appears to be more gender and sexual orientation diversity among students who applied RD vs. ED.

```{r}
ggplot(data = Survey_Responses[!is.na(Survey_Responses$Gender),], mapping = aes(x = ED, fill = Gender)) +
  geom_bar(position = "fill", na.rm = T) + 
  scale_fill_brewer(palette ="Set2") +
  theme_minimal() +
  scale_y_continuous(labels=scales::percent_format()) +
  labs(x = "Did you apply via the Early Decision process?", y = "")
```


```{r}
ggplot(data = Survey_Responses, mapping = aes(x = ED, fill = SexualOrientation)) +
  geom_bar(position = "fill") + 
  scale_fill_brewer(palette ="Set2") +
  theme_minimal() +
  scale_y_continuous(labels=scales::percent_format()) +
  labs(x = "Did you apply via the Early Decision process?", y = "", fill = "Sexual Orientation")
```

#### Race

There appears to be more racial diversity among students who applied RD vs. those who applied ED.

```{r}
Survey_Responses$Race <- factor(Survey_Responses$Race,levels = c("NA", "American Indian or Alaska Native", "Asian,Native Hawaiian or Pacific Islander", "Asian,Other", "Black or African American,Asian", "Black or African American,Other", "White,Black or African American,Asian", "Other", "White,American Indian or Alaska Native", "White,Other", "White,Asian", "White,Black or African American", "Black or African American", "Asian", "White"))
```


```{r}
Survey_Responses[!is.na(Survey_Responses$Race),] %>%
  group_by(ED, Race) %>% #group by both variables
  summarise(n = n()) %>% #count members per group
  group_by(ED) %>% #group just by the fill variable
  mutate(y = n/sum(n)) %>% #percent of each ED n per Race group
  ggplot()+
  geom_col(aes(y=y, x = Race, fill = as.factor(ED)), position="dodge")+
  scale_fill_brewer(palette ="Paired") +
  theme_minimal() +
  coord_flip() +
  scale_y_continuous(labels=scales::percent_format()) +
  labs(x = "Race/Ethnicity", y = "", fill = "Did you apply ED?")
```

```{r}
ggplot(data = Survey_Responses[!is.na(Survey_Responses$Race),], mapping = aes(x = ED, fill = Race)) +
  geom_bar(position = "fill") +
  scale_fill_manual(values = c('black','forestgreen', 'red2', 'orange', 'cornflowerblue', 
                'magenta', 'darkolivegreen4', 'indianred1', 'tan4', 'darkblue', 
                'mediumorchid1','firebrick4',  'yellowgreen', 'lightsalmon', 'tan3',
                "tan1",'darkgray', 'wheat4', '#DDAD4B', 'chartreuse', 
                'seagreen1', 'moccasin', 'mediumvioletred', 'seagreen','cadetblue1',
                "darkolivegreen1" ,"tan2" , "tomato3" , "#7CE3D8","gainsboro")) +
  theme_minimal() +
  scale_y_continuous(labels=scales::percent_format()) +
  labs(x = "Did you apply via the Early Decision process?", y = "", fill = "Race")
```

#### Trinity or Pratt

A larger proportion of students who applied ED are in Trinity compared to those who applied RD. 


```{r}
ggplot(data = Survey_Responses, mapping = aes(x = ED, fill = TrinityOrPratt)) +
  geom_bar(position = "fill") + 
  scale_fill_brewer(palette ="Paired") +
  theme_minimal() +
  scale_y_continuous(labels=scales::percent_format()) +
  labs(x = "Did you apply via the Early Decision process?", y = "", fill = "Are you in Trinity or Pratt?")
```

#### Major  

##### ED:

```{r}
Survey_Responses %>%
  filter(ED == "Yes") %>%
  count(Major) %>%
  mutate(prop = n/sum(n)) %>%
  arrange(desc(prop)) %>%
  kable()
```

##### RD:

```{r}
Survey_Responses %>%
  filter(ED == "No") %>%
  count(Major) %>%
  mutate(prop = n/sum(n)) %>%
  arrange(desc(prop)) %>%
  kable()
```



#### International Students

A larger proportion of students who applied ED are international students compared to those who applied RD.

```{r}
ggplot(data = Survey_Responses, mapping = aes(x = ED, fill = International)) +
  geom_bar(position = "fill") + 
  scale_fill_brewer(palette ="Paired") +
  theme_minimal() +
  scale_y_continuous(labels=scales::percent_format()) +
  labs(x = "Did you apply via the Early Decision process?", y = "", fill = "Are you an international student?")
```

```{r}
#ggsave("international.png")
```


#### Home community

A larger proportion of students who applied ED live in urban communities compared to those who applied RD.

```{r}
ggplot(data = Survey_Responses, mapping = aes(x = ED, fill = Community)) +
  geom_bar(position = "fill") + 
  scale_fill_brewer(palette ="RdYlBu") +
  theme_minimal() +
  scale_y_continuous(labels=scales::percent_format()) +
  labs(x = "Did you apply via the Early Decision process?", y = "", fill = "What community are you from?")
```
```{r}
#ggsave("HomeCommunity.png")
```


#### Family annual income

A larger proportion of families of students who applied ED have an estimated annual income of above $250,000 compared to families of students who applied RD.

```{r}
Survey_Responses$FamilyAnnualIncome <- factor(
  Survey_Responses$FamilyAnnualIncome,levels = c("NA", "Below $40,000", 
                                                 "$40,000-$80,000", "$80,000-$125,000", 
                                                 "$125,000-$250,000", "$250,000-$500,000", 
                                                 "Above $500,000"))
```


```{r}
Survey_Responses[!is.na(Survey_Responses$FamilyAnnualIncome),] %>%
  group_by(ED, FamilyAnnualIncome) %>% #group by both variables
  summarise(n = n()) %>% #count members per group
  group_by(ED) %>% #group just by the fill variable
  mutate(y = n/sum(n)) %>% #percent of each ED n per Race group
  ggplot()+
  geom_col(aes(y=y, x = FamilyAnnualIncome, fill = as.factor(ED)), position="dodge")+
  scale_fill_brewer(palette ="Paired") +
  theme_minimal() +
  coord_flip() +
  scale_y_continuous(labels=scales::percent_format()) +
  labs(x = "Estimated Family Annual Income", y = "", fill = "Did you apply ED?")
```

```{r}
#ggsave("FamilyIncome.png")
```


```{r}
ggplot(data = Survey_Responses[!is.na(Survey_Responses$FamilyAnnualIncome),], mapping = aes(x = ED, fill = FamilyAnnualIncome)) +
  geom_bar(position = "fill") + 
  scale_fill_brewer(palette ="Set2") +
  theme_minimal() +
  scale_y_continuous(labels=scales::percent_format()) +
  labs(x = "Did you apply via the Early Decision process?", y = "", fill = "Estimated Family Annual Income")
```
```{r}
#ggsave("FamilyIncome2.png")
```


#### Financial aid

A larger proportion of students who applied RD receive financial aid from Duke compared to those who applied ED.

```{r}
ggplot(data = Survey_Responses[!is.na(Survey_Responses$FinAid),], mapping = aes(x = ED, fill = FinAid)) +
  geom_bar(position = "fill", na.rm = T) + 
  scale_fill_brewer(palette ="Paired") +
  theme_minimal() +
  scale_y_continuous(labels=scales::percent_format()) +
  labs(x = "Did you apply via the Early Decision process?", y = "", fill = "Do you receive financial aid from Duke?")
```
```{r}
#ggsave("FinAid.png")
```


#### Interest in Greek life and SLGs

A larger proportion of students who applied ED are at least slightly interested in Greek life and SLGs compared to those who applied RD.

```{r}
Survey_Responses$Greek <- factor(Survey_Responses$Greek,levels = c("Extremely interested", "Very interested", "Moderately interested", "Slightly interested", "Not interested at all"))
```

```{r}
Survey_Responses$SLG <- factor(Survey_Responses$SLG,levels = c("Extremely interested", "Very interested", "Moderately interested", "Slightly interested", "Not interested at all"))
```

```{r}
ggplot(data = Survey_Responses, mapping = aes(x = ED, fill = Greek)) +
  geom_bar(position = "fill") + 
  scale_fill_brewer(palette ="Set2") +
  theme_minimal() +
  scale_y_continuous(labels=scales::percent_format()) +
  labs(x = "Did you apply via the Early Decision process?", y = "", fill = "How interested are you in Greek life at Duke?")
```
```{r}
#ggsave("Greek.png")
```


```{r}
ggplot(data = Survey_Responses, mapping = aes(x = ED, fill = SLG)) +
  geom_bar(position = "fill") + 
  scale_fill_brewer(palette ="Set2") +
  theme_minimal() +
  scale_y_continuous(labels=scales::percent_format()) +
  labs(x = "Did you apply via the Early Decision process?", y = "", fill = "How interested are you in SLG life at Duke?")
```
```{r}
#ggsave("SLG.png")
```


#### Type of secondary school

A larger proportion of students who applied ED attended some sort of private school than those who applied RD.

```{r}
ggplot(data = Survey_Responses, mapping = aes(x = ED, fill = SecondarySchoolType)) +
  geom_bar(position = "fill") +
  scale_fill_brewer(palette ="Set2") +
  theme_minimal() +
  scale_y_continuous(labels=scales::percent_format()) +
  labs(x = "Did you apply via the Early Decision process?", y = "", fill = "What type of secondary school did you attend?")
```
```{r}
#ggsave("SecondarySchool.png")
```


#### Legacy

A larger proportion of students who applied ED have parents or siblings who attended Duke compared to those who applied RD.

```{r}
ggplot(data = Survey_Responses, mapping = aes(x = ED, fill = Legacy)) +
  geom_bar(position = "fill") + 
  scale_fill_brewer(palette = "Paired") +
  theme_minimal() +
  scale_y_continuous(labels=scales::percent_format()) +
  labs(x = "Did you apply via the Early Decision process?", y = "", fill = "Did any of your parents or siblings attend Duke?")
```


```{r}
#ggsave("Legacy.png")
```









```{r eval = FALSE}
ggplot(data = Survey_Responses, mapping = aes(x = ED, fill = VarsityAthlete)) +
  geom_bar(position = "fill") + 
  scale_fill_brewer(palette ="Paired") +
  theme_minimal() +
  scale_y_continuous(labels=scales::percent_format()) +
  labs(title = "Varsity Athlete", x = "Did you apply via the Early Decision process?", y = "", fill = "Are you a recruited varsity athlete?")
```

```{r eval = FALSE}
EDYes <- 
  Survey_Responses %>%
  filter(ED == "Yes")

```

```{r eval = FALSE}
EDNo <- 
  Survey_Responses %>%
  filter(ED == "No")
```


```{r warning = FALSE, eval = FALSE}
ggplot(data = EDYes, mapping = aes(x = NumApps)) +
  geom_histogram(binwidth = 1, fill = "#6699ff", color = "black") + 
  theme_minimal() +
  labs(title = "Number of Colleges/Universities Applied to Among ED Students", x = "Number of Colleges/Universities Applied to")
```

```{r warning = FALSE, eval = FALSE}
ggplot(data = EDNo, mapping = aes(x = NumApps)) +
  geom_histogram(binwidth = 1, fill = "#6699ff", color = "black") + 
  theme_minimal() +
  labs(title = "Number of Colleges/Universities Applied to Among RD Students", x = "Number of Colleges/Universities Applied to")
```